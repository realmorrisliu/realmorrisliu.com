---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import "../../styles/global.css";

const posts = (await getCollection("blog"))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const formatDate = (date: Date) => {
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
};
---

<Layout 
  title="Thoughts - Morris Liu"
  description="Technical thoughts and insights from Morris Liu on software engineering, leadership, AI infrastructure, and open source development. Stories behind building tools like Sealbox and Kira."
>
  <div class="mx-auto max-w-2xl px-6 py-16">
    <header class="mb-16">
      <h1 class="mb-2 font-serif text-4xl leading-tight">Thoughts</h1>
    </header>

    <div class="space-y-16">
      {
        posts.map(post => (
          <article class="border-b pb-12" style="border-color: var(--color-border);">
            <div class="mb-4">
              <h2 class="mb-2 font-serif text-2xl leading-tight">
                <a
                  href={`/thoughts/${post.id.replace(/\.md$/, "")}`}
                  style="color: var(--color-text-primary);"
                >
                  {post.data.title}
                </a>
              </h2>
              <time class="text-sm font-normal" style="color: var(--color-text-tertiary);">
                {formatDate(post.data.pubDate)}
              </time>
            </div>
            <p class="text-base leading-relaxed" style="color: var(--color-text-secondary);">
              {post.data.description}
            </p>

            {post.data.tags && post.data.tags.length > 0 && (
              <div class="mt-4 flex flex-wrap gap-2">
                {post.data.tags.map(tag => (
                  <span
                    class="rounded-full border px-2 py-1 text-xs"
                    style="color: var(--color-text-tertiary); border-color: var(--color-border);"
                  >
                    {tag}
                  </span>
                ))}
              </div>
            )}
          </article>
        ))
      }
    </div>

    {
      posts.length === 0 && (
        <div class="py-16 text-center">
          <p class="text-lg" style="color: var(--color-text-secondary);">
            No thoughts yet. Create your first post in <code>src/content/blog/</code>
          </p>
        </div>
      )
    }

    <!-- 信件结尾式返回链接 -->
    <footer class="mt-24 pt-8">
      <p class="font-serif text-base" style="color: var(--color-text-secondary);">
        <a href="/" style="color: var(--color-text-link);">Morris Liu</a>
      </p>
    </footer>
  </div>
</Layout>
