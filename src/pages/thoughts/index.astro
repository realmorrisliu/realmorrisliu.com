---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import '../../styles/global.css';

const posts = (await getCollection('blog'))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const formatDate = (date: Date) => {
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
};
---

<Layout title="Thoughts - Morris Liu">
  <div class="max-w-2xl mx-auto px-6 py-16">
    <header class="mb-16">
      <h1 class="text-4xl font-serif mb-2 leading-tight">Thoughts</h1>
    </header>
    
    <div class="space-y-16">
      {posts.map((post) => (
        <article class="border-b pb-12" style="border-color: var(--color-border);">
          <div class="mb-4">
            <h2 class="text-2xl font-serif mb-2 leading-tight">
              <a 
                href={`/thoughts/${post.id.replace(/\.md$/, '')}`}
                style="color: var(--color-text-primary);"
              >
                {post.data.title}
              </a>
            </h2>
            <time class="text-sm font-normal" style="color: var(--color-text-tertiary);">
              {formatDate(post.data.pubDate)}
            </time>
          </div>
          <p class="text-base leading-relaxed" style="color: var(--color-text-secondary);">
            {post.data.description}
          </p>
          
          {post.data.tags && post.data.tags.length > 0 && (
            <div class="flex flex-wrap gap-2 mt-4">
              {post.data.tags.map(tag => (
                <span 
                  class="text-xs px-2 py-1 rounded-full border" 
                  style="color: var(--color-text-tertiary); border-color: var(--color-border);"
                >
                  {tag}
                </span>
              ))}
            </div>
          )}
        </article>
      ))}
    </div>
    
    {posts.length === 0 && (
      <div class="text-center py-16">
        <p class="text-lg" style="color: var(--color-text-secondary);">
          No thoughts yet. Create your first post in <code>src/content/blog/</code>
        </p>
      </div>
    )}
    
    <!-- 信件结尾式返回链接 -->
    <footer class="mt-24 pt-8">
      <p class="text-base font-serif" style="color: var(--color-text-secondary);">
        <a href="/" style="color: var(--color-text-link);">Morris Liu</a>
      </p>
    </footer>
  </div>
</Layout>