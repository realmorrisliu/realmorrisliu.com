---
import { getCollection } from "astro:content";
import Link from "./Link.astro";
import { formatDate } from "../utils/dateUtils";

// Get the latest now entry
const nowEntries = await getCollection("now");
const latestEntry = nowEntries.sort(
  (a, b) => new Date(b.data.lastUpdated).getTime() - new Date(a.data.lastUpdated).getTime()
)[0];

const { summary, lastUpdated } = latestEntry.data;
---

<section class="current-status mb-8 border-l-2 border-[color:var(--color-border)] py-3 pl-4">
  <p class="mb-2 text-base leading-relaxed">
    <span class="font-medium text-[color:var(--color-text-primary)]">Currently:</span>
    <span class="ml-1 text-[color:var(--color-text-secondary)]">{summary}</span>
  </p>
  <p class="mb-2 text-sm leading-normal text-[color:var(--color-text-tertiary)]">
    Last updated {formatDate(lastUpdated)}
  </p>
  <p class="text-sm leading-normal text-[color:var(--color-text-tertiary)]">
    <Link href="/now" class="text-sm"> â†’ Learn more about what I'm up to now </Link>
  </p>
</section>
