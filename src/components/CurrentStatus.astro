---
import { getCollection } from "astro:content";

// Get the latest now entry
const nowEntries = await getCollection("now");
const latestEntry = nowEntries.sort((a, b) => 
  new Date(b.data.lastUpdated).getTime() - new Date(a.data.lastUpdated).getTime()
)[0];

const { summary, lastUpdated } = latestEntry.data;

// Format the date for display
const formatDate = (dateString: string): string => {
  const date = new Date(dateString);
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
};
---

<section class="current-status mb-8 border-l-2 border-[color:var(--color-border)] py-3 pl-4">
  <p class="mb-2 text-base leading-relaxed">
    <span class="font-medium text-[color:var(--color-text-primary)]">Currently:</span>
    <span class="ml-1 text-[color:var(--color-text-secondary)]">{summary}</span>
  </p>
  <p class="mb-2 text-sm leading-normal text-[color:var(--color-text-tertiary)]">
    Last updated {formatDate(lastUpdated)}
  </p>
  <p class="text-sm leading-normal text-[color:var(--color-text-tertiary)]">
    <a href="/now" class="font-medium text-[color:var(--color-text-link)] hover:underline">
      â†’ Learn more about what I'm up to now
    </a>
  </p>
</section>
