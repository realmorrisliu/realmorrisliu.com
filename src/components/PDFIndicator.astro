---
import Button from "./Button.astro";
import Link from "./Link.astro";
import { getTranslations } from "../i18n/utils";

export interface Props {
  currentLang: "en" | "zh";
  backUrl: string;
}

const { currentLang, backUrl } = Astro.props;
const t = getTranslations(currentLang);
---

<div class="mb-4 bg-gray-100 px-4 py-3.5 font-sans sm:mb-5 sm:px-5 sm:py-4 print:hidden">
  <div
    class="mb-2.5 flex flex-col items-start gap-3 sm:mb-3 sm:flex-row sm:items-center sm:justify-between sm:gap-4"
  >
    <div class="flex flex-1 items-center gap-2.5 sm:gap-3">
      <svg
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="currentColor"
        class="text-text-tertiary flex-shrink-0"
      >
        <title>PDF</title>
        <path
          d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"
        ></path>
      </svg>
      <div class="flex-1">
        <span
          class="text-text-secondary m-0 text-[0.8125rem] leading-[var(--line-height-normal)] font-normal sm:text-sm"
        >
          {t.soFar.pdf.title}
        </span>
      </div>
    </div>

    <div class="flex flex-shrink-0 items-center gap-2">
      <!-- Language Toggle -->
      <Button
        href={currentLang === "en" ? "/so-far/pdf/zh" : "/so-far/pdf"}
        variant="secondary"
        size="sm"
      >
        {currentLang === "en" ? "中文" : "English"}
      </Button>

      <Button id="print-button" variant="primary" size="sm">
        {t.soFar.pdf.printButton}
      </Button>
    </div>
  </div>

  <div
    class="flex flex-col items-start gap-2 text-xs sm:flex-row sm:items-center sm:justify-between sm:gap-4"
  >
    <p class="text-text-tertiary m-0 flex-1 text-[0.6875rem] italic sm:text-xs">
      {t.soFar.pdf.printButtonHint}
    </p>
    <Link href={backUrl} class="text-[0.6875rem] whitespace-nowrap sm:text-xs">
      {t.soFar.pdf.backText}
    </Link>
  </div>
</div>

<script>
  // Auto-trigger print dialog after page loads
  window.addEventListener("load", () => {
    setTimeout(() => {
      window.print();
    }, 500);
  });

  // Manual print button handler
  document.addEventListener("DOMContentLoaded", () => {
    const printButton = document.getElementById("print-button");
    if (printButton) {
      printButton.addEventListener("click", () => {
        window.print();
      });
    }
  });
</script>
